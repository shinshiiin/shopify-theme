<div class="section {{ section.id }}" id="tutorials">
  <div class="container">

    {% if section.settings.title != blank %}
      <h2 class="section-title">{{ section.settings.title }}</h2>
    {% endif %}
    {% if section.settings.subtitle != blank %}
      <p class="section-subtitle">{{ section.settings.subtitle }}</p>
    {% endif %}

    <div class="card-grid">
      <div class="card-scroll-wrapper"> 
        {% for block in section.blocks %}
          <div class="card" {{ block.shopify_attributes }}>
            <div class="card-video">
              {% if block.settings.video %}
                {{ block.settings.video | video_tag: image_size: '1100x', autoplay: true, loop: true, controls: false, muted: true }}
              {% else %}
                <div class="card-placeholder"></div>
              {% endif %}
            </div>
            <div class="text-container">{{ block.settings.text }}</div>
          </div>
        {% endfor %}
      </div>
    </div>

  </div>
</div>

<style>
.{{ section.id }} {
  padding: 64px 0;
  background: #fff;
  overflow-x: hidden; /* Prevents unwanted horizontal scroll on the whole page */
}

.{{ section.id }} .container {
  display: flex;
  flex-direction: column;
}

.{{ section.id }} .section-title {
  text-align: center;
  font-size: 28px;
  font-weight: 700;
  margin-bottom: 7px;
  color: {{ section.settings.title_color }};
}

.{{ section.id }} .section-subtitle {
  text-align: center;
  font-size: 20px;
  margin-bottom: 48px;
  max-width: 691px;
  color: {{ section.settings.subtitle_color }};
  align-self: center;
}

.{{ section.id }} .card-grid {
  width: 100%;
}

.{{ section.id }} .card-scroll-wrapper {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 20px;
}

.{{ section.id }} .card {
  text-align: center;
  position: relative;
}

.{{ section.id }} .card-video {
  width: 100%;
  aspect-ratio: 3 / 5;
  background: #e0e0e0;
  border-radius: 10px;
  overflow: hidden;
  margin-bottom: 16px;
}

.{{ section.id }} .card-video video {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.{{ section.id }} .card-placeholder {
  width: 100%;
  height: 100%;
  background: #d9d9d9;
}

.{{ section.id }} .routine-step-title {
  font-size: 14px;
  font-weight: 700;
  margin-bottom: 8px;
  text-align: center !important;
}

.{{ section.id }} .text-container {
    position: absolute;
    inset: 0;
    display: flex;
    flex-direction: column;
    padding: 11px 19px;
    align-self: end;
    align-items: center;
    background: linear-gradient(to bottom, rgba(255, 202, 202, 1), rgba(255, 202, 202, 0.5));
    border-radius: 0 0 10px 10px;
  }

.{{ section.id }} .routine-tip {
  margin-top: 48px;
  background: #e56a7b;
  color: #fff;
  padding: 16px 20px;
  border-radius: 10px;
  display: flex;
  align-items: center;
  gap: 12px;
  max-width: 820px;
  margin-left: auto;
  margin-right: auto;
  font-size: 14px;
}

.{{ section.id }} .routine-tip p{ margin: 0; }
.{{ section.id }} .tip-icon { font-size: 20px; width: 24px; height: 24px; }
.{{ section.id }} .tip-icon img { width: 100%; height: auto; }

/* Tablet */
@media (max-width: 1024px) {
  .{{ section.id }} .card-scroll-wrapper {
    grid-template-columns: repeat(2, 1fr);
  }
}

/* Mobile Carousel Style */
@media (max-width: 640px) {
  #tutorials {
    padding-bottom: 0;
  }
  .{{ section.id }} {
    padding: 20px 0;
  }

  .{{ section.id }} .container {
    padding: 0px 10px; 
  }

  .{{ section.id }} .section-title {
    font-size: 22px;
    margin-bottom: 32px;
    padding-right: 20px; /* Centers title relative to screen */
  }

  .{{ section.id }} .card-scroll-wrapper {
    display: flex;
    overflow-x: auto;
    scroll-snap-type: x mandatory;
    scroll-behavior: smooth;
    -webkit-overflow-scrolling: touch;
    gap: 15px;
  }

  /* Hide scrollbar for Chrome, Safari and Opera */
  .{{ section.id }} .card-scroll-wrapper::-webkit-scrollbar {
    display: none;
  }

  .{{ section.id }} .card {
    flex: 0 0 75%; /* Adjust this percentage to show more/less of the next card */
    scroll-snap-align: start;
    text-align: left; /* Matching the style in your image */
  }

  {% comment %} .{{ section.id }} .card-video {
    aspect-ratio: 0.8 / 1; /* Slightly wider for mobile visibility if preferred */
  } {% endcomment %}

  .{{ section.id }} .routine-tip {
    margin: 0;
    flex-direction: column;
    text-align: center;
  }
}
</style>

{% schema %}
{
  "name": "UGC Videos 2",
  "settings": [
    {
      "type": "text",
      "id": "title",
      "label": "Section Title",
      "default": "Title"
    },
    {
      "type": "color",
      "id": "title_color",
      "label": "Title Color",
      "default": "#d65a6d"
    },
    {
      "type": "text",
      "id": "subtitle",
      "label": "Section Subtitle",
      "default": "Subtitle"
    },
    {
      "type": "color",
      "id": "subtitle_color",
      "label": "Subtitle Color",
      "default": "#292929"
    }
  ],
  "blocks": [
    {
      "type": "card",
      "name": "Card",
      "settings": [
        {
          "type": "video",
          "id": "video",
          "label": "Video"
        },
        {
          "type": "richtext",
          "id": "text",
          "label": "Step Description"
        }
      ]
    }
  ],
  "max_blocks": 4,
  "presets": [
    {
      "name": "UGC Videos 2",
      "blocks": [
        { "type": "card" },
        { "type": "card" },
        { "type": "card" },
        { "type": "card" }
      ]
    }
  ]
}
{% endschema %}
