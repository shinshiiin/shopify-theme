<div class="bb">
  <div class="section {{ section.id }}" id="tutorials">
    <div class="container">

      {% if section.settings.title != blank %}
        <h2 class="routine-title">{{ section.settings.title }}</h2>
      {% endif %}
      {% if section.settings.subtitle != blank %}
        <p class="routine-subtitle">{{ section.settings.subtitle }}</p>
      {% endif %}

      <div class="routine-grid">
        <div class="routine-scroll-wrapper"> {% for block in section.blocks %}
            <div class="routine-card" {{ block.shopify_attributes }}>
              <div class="routine-image">
                {% if block.settings.video %}
                  {{ block.settings.video | video_tag: image_size: '1100x', autoplay: true, loop: true, controls: false, muted: true }}
                {% else %}
                  <div class="routine-placeholder"></div>
                {% endif %}
              </div>
              <h3 class="routine-step-title">{{ block.settings.title }}</h3>
              <div class="routine-text">{{ block.settings.text }}</div>
            </div>
          {% endfor %}
        </div>
      </div>

      {% if section.settings.tip_text != blank %}
        <div class="routine-tip">
          <span class="tip-icon">
              <img
              src="{{ 'idea.webp' | asset_url }}"
              alt=""
              class="first_image"
              loading="lazy">
          </span>
          <p>{{ section.settings.tip_text }}</p>
        </div>
      {% endif %}

    </div>
  </div>
</div>

<style>
.{{ section.id }} {
  padding: 64px 0;
  background: #fff;
  overflow-x: hidden; /* Prevents unwanted horizontal scroll on the whole page */
}

.{{ section.id }} .container {
  display: flex;
  flex-direction: column;
}

.{{ section.id }} .routine-title {
  text-align: center;
  font-size: 28px;
  font-weight: 700;
  margin-bottom: 7px;
  color: {{ section.settings.title_color }};
}

.{{ section.id }} .routine-subtitle {
  text-align: center;
  font-size: 20px;
  margin-bottom: 48px;
  max-width: 691px;
  color: {{ section.settings.subtitle_color }};
  align-self: center;
}

.{{ section.id }} .routine-grid {
  width: 100%;
}

.{{ section.id }} .routine-scroll-wrapper {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 20px;
}

.{{ section.id }} .routine-card {
  text-align: center;
}

.{{ section.id }} .routine-image {
  width: 100%;
  aspect-ratio: 3 / 5;
  background: #e0e0e0;
  border-radius: 10px;
  overflow: hidden;
  margin-bottom: 16px;
}

.{{ section.id }} .routine-image video {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.{{ section.id }} .routine-placeholder {
  width: 100%;
  height: 100%;
  background: #d9d9d9;
}

.{{ section.id }} .routine-step-title {
  font-size: 14px;
  font-weight: 700;
  margin-bottom: 8px;
  text-align: center !important;
}

.{{ section.id }} .routine-text {
  font-size: 13px;
  line-height: 1.5;
  color: #333;
  padding: 0 10px;
  text-align: center !important;
}

.{{ section.id }} .routine-tip {
  margin-top: 48px;
  background: #e56a7b;
  color: #fff;
  padding: 16px 20px;
  border-radius: 10px;
  display: flex;
  align-items: center;
  gap: 12px;
  max-width: 820px;
  margin-left: auto;
  margin-right: auto;
  font-size: 14px;
}

.{{ section.id }} .routine-tip p{ margin: 0; }
.{{ section.id }} .tip-icon { font-size: 20px; width: 24px; height: 24px; }
.{{ section.id }} .tip-icon img { width: 100%; height: auto; }

/* Tablet */
@media (max-width: 1024px) {
  .{{ section.id }} .routine-scroll-wrapper {
    grid-template-columns: repeat(2, 1fr);
  }
}

/* Mobile Carousel Style */
@media (max-width: 640px) {
  #tutorials {
    padding-bottom: 0;
  }
  .{{ section.id }} {
    padding: 20px 0;
  }

  .{{ section.id }} .container {
    padding: 0px 10px; 
  }

  .{{ section.id }} .routine-title {
    font-size: 22px;
    margin-bottom: 32px;
    padding-right: 20px; /* Centers title relative to screen */
  }

  .{{ section.id }} .routine-scroll-wrapper {
    display: flex;
    overflow-x: auto;
    scroll-snap-type: x mandatory;
    scroll-behavior: smooth;
    -webkit-overflow-scrolling: touch;
    gap: 15px;
  }

  /* Hide scrollbar for Chrome, Safari and Opera */
  .{{ section.id }} .routine-scroll-wrapper::-webkit-scrollbar {
    display: none;
  }

  .{{ section.id }} .routine-card {
    flex: 0 0 75%; /* Adjust this percentage to show more/less of the next card */
    scroll-snap-align: start;
    text-align: left; /* Matching the style in your image */
  }

  {% comment %} .{{ section.id }} .routine-image {
    aspect-ratio: 0.8 / 1; /* Slightly wider for mobile visibility if preferred */
  } {% endcomment %}

  .{{ section.id }} .routine-tip {
    margin: 0;
    flex-direction: column;
    text-align: center;
  }
}
</style>

{% schema %}
{
  "name": "Daily Routine",
  "settings": [
    {
      "type": "text",
      "id": "title",
      "label": "Section Title",
      "default": "Your Complete Daily Routine"
    },
    {
      "type": "color",
      "id": "title_color",
      "label": "Title Color",
      "default": "#d65a6d"
    },
    {
      "type": "text",
      "id": "subtitle",
      "label": "Section Subtitle",
      "default": "Your Complete Daily Routine"
    },
    {
      "type": "color",
      "id": "subtitle_color",
      "label": "Subtitle Color",
      "default": "#292929"
    },
    {
      "type": "textarea",
      "id": "tip_text",
      "label": "Pro Tip Text",
      "default": "Pro Tip: Use the Gray Repair Serum at night so it can work while you sleep. Apply the Spray in the morning and evening for continuous follicle supportâ€”without chemicals or damage."
    }
  ],
  "blocks": [
    {
      "type": "step",
      "name": "Routine Step",
      "settings": [
        {
          "type": "video",
          "id": "video",
          "label": "Video"
        },
        {
          "type": "text",
          "id": "title",
          "label": "Step Title",
          "default": "Step title"
        },
        {
          "type": "richtext",
          "id": "text",
          "label": "Step Description"
        }
      ]
    }
  ],
  "max_blocks": 4,
  "presets": [
    {
      "name": "Daily Routine",
      "blocks": [
        { "type": "step" },
        { "type": "step" },
        { "type": "step" },
        { "type": "step" }
      ]
    }
  ]
}
{% endschema %}
