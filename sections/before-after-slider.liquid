{%- style -%}
  .ba-slider-section {
    padding: {{ section.settings.padding_top }}px 20px {{ section.settings.padding_bottom }}px 20px;
    background-color: #fcf9f6;
    overflow: hidden;
  }
  .ba-slider-container {
    max-width: 1400px;
    margin: 0 auto;
    display: flex;
    flex-direction: column;
    gap: 40px;
  }
  @media (min-width: 768px) {
    .ba-slider-container { flex-direction: row; align-items: flex-start; }
  }
  .ba-slider-info { flex: 0 0 100%; }
  @media (min-width: 768px) { .ba-slider-info { flex: 0 0 30%; } }
  .ba-title { font-size: 2.5rem; font-weight: 700; line-height: 1.1; margin-bottom: 15px; color: #000; }
  .ba-subtitle { font-size: 1.1rem; font-weight: 400; line-height: 1.5; color: #333; }
  
  .ba-slider-controls { display: flex; gap: 15px; margin-top: 30px; }
  .ba-arrow {
    width: 45px; height: 45px; border-radius: 50%; border: none; background: #fff;
    cursor: pointer; display: flex; align-items: center; justify-content: center;
    transition: all 0.3s ease; box-shadow: 0 2px 5px rgba(0,0,0,0.1);
  }
  .ba-arrow:hover { box-shadow: 0 4px 10px rgba(0,0,0,0.15); background: #eee; }
  
  /* Splide Track & Wrapper */
  .ba-slider-track-wrapper { flex: 1; min-width: 0; padding-bottom: 40px; /* Space for dots */ }
  .ba-card {
    width: 450px; background: #fff; border-radius: 16px; padding: 20px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.05); margin-bottom: 10px;
  }
  @media (max-width: 480px) { .ba-card { width: 280px; } }
  .ba-card-images { display: flex; gap: 10px; margin-bottom: 20px; }
  .ba-img-wrapper { flex: 1; position: relative; border-radius: 8px; overflow: hidden; }
  .ba-img-wrapper img { width: 100%; display: block; aspect-ratio: 1/1; object-fit: cover; }
  .ba-label {
    position: absolute; bottom: 0; left: 0; width: 100%; text-align: center;
    font-size: 10px; font-weight: 700; text-transform: uppercase; padding: 6px 0; color: #fff;
  }
  .ba-label.before { background: #000; }
  .ba-label.during { background: #f23440; }
  .ba-testimonial { font-size: 15px; line-height: 1.4; margin: 12px 0; min-height: 60px; }
  .ba-user { display: flex; align-items: center; gap: 12px; margin-top: 20px; }
  .ba-avatar { width: 50px; height: 50px; border-radius: 50%; object-fit: cover; }
  .ba-user-name { font-weight: 700; font-size: 14px; text-transform: uppercase; }
  .ba-tag {
    display: inline-block; background: #f0f0f0; padding: 5px 12px;
    border-radius: 20px; font-size: 11px; font-weight: 600; margin-top: 15px;
  }

  /* Pagination (Bullets) Styling */
  .splide__pagination {
    bottom: 0px !important;
    padding: 0;
    margin-top: 20px;
    position: relative !important;
  }
  .splide__pagination__page {
    background: #ccc;
    border: none;
    height: 8px;
    width: 8px;
    margin: 0 4px;
    transition: all 0.3s ease;
    opacity: 1;
  }
  .splide__pagination__page.is-active {
    background: #f23440; /* Match your brand red */
    transform: scale(1.4);
    width: 20px; /* Makes the active dot an oval/pill shape */
    border-radius: 10px;
  }
{%- endstyle -%}

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@splidejs/splide@4.1.4/dist/css/splide.min.css">

<section id="ba-section-{{ section.id }}" class="ba-slider-section">
  <div class="ba-slider-container">
    
    <div class="ba-slider-info">
      <div class="ba-slider-headings">
        <h2 class="ba-title">{{ section.settings.title }}</h2>
        <h3 class="ba-subtitle">{{ section.settings.subtitle }}</h3>
      </div>

      <div class="ba-slider-controls">
        <button class="ba-arrow splide__arrow--prev" aria-label="Previous slide">
          <svg width="8" height="12" viewBox="0 0 8 12" fill="none"><path d="M2.62344 5.99966L7.02344 10.3997L5.76655 11.6566L0.10966 5.99966L5.76655 0.342773L7.02344 1.59966L2.62344 5.99966Z" fill="currentColor"></path></svg>
        </button>
        <button class="ba-arrow splide__arrow--next" aria-label="Next slide">
          <svg width="8" height="12" viewBox="0 0 8 12" fill="none"><path d="M5.38437 6.00034L0.984375 1.60034L2.24126 0.34345L7.89815 6.00034L2.24126 11.6572L0.984375 10.4003L5.38437 6.00034Z" fill="currentColor"></path></svg>
        </button>
      </div>
    </div>

    <div class="ba-slider-track-wrapper splide">
      <div class="splide__track">
        <div class="splide__list">
          {%- for i in (1..5) -%}
          <div class="splide__slide">
            <div class="ba-card">
              <div class="ba-card-images">
                <div class="ba-img-wrapper">
                  <img src="https://www.irestorelaser.com/cdn/shop/files/Before_ID505_Male_Albert_L_FB_Group_2022_250x250_94284e7f-8d25-4468-9e7e-101076ddf172.jpg?v=1713909742&width=500" alt="Before" loading="lazy">
                  <span class="ba-label before">Before</span>
                </div>
                <div class="ba-img-wrapper">
                  <img src="https://www.irestorelaser.com/cdn/shop/files/After_ID505_Male_Albert_L_FB_Group_2022_250x250_9b26cfc8-13dc-4255-b84e-17feaff1ac84.jpg?v=1713909753&width=500" alt="During" loading="lazy">
                  <span class="ba-label during">During</span>
                </div>
              </div>
              <div class="ba-card-content">
                <svg width="15" height="13" viewBox="0 0 15 13" fill="none"><path d="M14.832 9.6C14.832 7.776 13.536 6.672 11.952 6.672C11.472 6.672 11.136 6.816 10.992 6.912C11.04 4.944 12.48 2.736 14.592 2.256V0C11.904 0.287999 8.208 2.736 8.208 8.4C8.208 11.136 9.84 12.48 11.712 12.48C13.488 12.48 14.832 11.184 14.832 9.6ZM6.624 9.6C6.624 7.776 5.328 6.672 3.744 6.672C3.264 6.672 2.928 6.816 2.784 6.912C2.832 4.944 4.272 2.736 6.384 2.256V0C3.696 0.287999 0 2.736 0 8.4C0 11.136 1.632 12.48 3.504 12.48C5.28 12.48 6.624 11.184 6.624 9.6Z" fill="#F23440"></path></svg>
                <p class="ba-testimonial">I have been using the iRestore for 6 months. I am seeing significant growth in my crown.</p>
                <div class="ba-user">
                  <img class="ba-avatar" src="https://www.irestorelaser.com/cdn/shop/files/UGC_ID510_Male_David_W_SMS_2024_75x75_fde169d6-503f-4596-91d2-ee0e9b4473b8.webp?crop=center&height=80&width=80" alt="User">
                  <span class="ba-user-name">Albert L. | 37</span>
                </div>
              </div>
            </div>
          </div>
          {%- endfor -%}
        </div>
      </div>
      </div>
  </div>
</section>

<script src="https://cdn.jsdelivr.net/npm/@splidejs/splide@4.1.4/dist/js/splide.min.js"></script>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    const sectionId = "{{ section.id }}";
    const splide = new Splide(`#ba-section-${sectionId} .splide`, {
      type: 'loop',
      gap: '1rem',
      padding: '1rem',
      autoWidth: true,
      arrows: false,
      pagination: true, // <-- SET THIS TO TRUE
      mediaQuery: 'min',
      breakpoints: {
        380: { gap: '1.25rem', padding: '1.25rem' },
        1280: { gap: '2rem', padding: '0' },
      },
    }).mount();

    // Link custom arrows to splide
    const $prev = document.querySelector(`#ba-section-${sectionId} .splide__arrow--prev`);
    const $next = document.querySelector(`#ba-section-${sectionId} .splide__arrow--next`);

    $prev.addEventListener('click', () => splide.go('<'));
    $next.addEventListener('click', () => splide.go('>'));
  });
</script>

{% schema %}
{
  "name": "Before & After Slider",
  "settings": [
    { "type": "text", "id": "title", "label": "Heading", "default": "Helmet Hair Has Never Looked Better" },
    { "type": "textarea", "id": "subtitle", "label": "Subheading", "default": "Join over 600,000 customers who overcame hair loss with iRESTORE." },
    { "type": "range", "id": "padding_top", "min": 0, "max": 100, "step": 4, "unit": "px", "label": "Padding Top", "default": 60 },
    { "type": "range", "id": "padding_bottom", "min": 0, "max": 100, "step": 4, "unit": "px", "label": "Padding Bottom", "default": 60 }
  ],
  "presets": [{ "name": "Before & After Slider" }]
}
{% endschema %}